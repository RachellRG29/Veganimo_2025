<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
      
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css">
    <!-- Gloock y Comfortaa fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&family=Gloock&display=swap" rel="stylesheet">

    <!-- Iconos de Phosphor -->
    <link rel="stylesheet" href="https://unpkg.com/@phosphor-icons/web@2.0.3/src/phosphor.css">

    <!-- Estilos de las pantallas -->
    <link rel="stylesheet" href="/Pantalla_principal/css/styles_index_pp.css">
    <link rel="stylesheet" href="/Pantalla_principal/css/styles_index_pp_sidebar.css">
    <link rel="stylesheet" href="/Pantalla_principal/css/styles_pp_inicio.css">
    <link rel="stylesheet" href="/Pantalla_principal/css/styles_pp_recetas.css">
    <link rel="stylesheet" href="/Pantalla_principal/css/styles_pp_informate.css">

    <link rel="stylesheet" href="/Pantalla_principal/contenidos/plan/styles_pp_plan.css">
    <link rel="stylesheet" href="/Pantalla_principal/contenidos/plan/styles_pp_plan_dash.css">
    <link rel="stylesheet" href="/Pantalla_principal/contenidos/plan/style_modales-plan.css.css">

    <link rel="stylesheet" href="/Pantalla_principal/css/styles_pp_dietas.css">
    <link rel="stylesheet" href="/Pantalla_principal/css/styles_pp_nodietas.css">

    <link rel="stylesheet" href="/Pantalla_principal/css/style_crear_receta.css"> <!-- Estilos para crear recetas -->
    <link rel="stylesheet" href="/Pantalla_principal/css/style_crear_r_resp.css"> <!-- Responsividad de crear recetas y pro -->
    <link rel="stylesheet" href="/Pantalla_principal/css/style_modal_recetas.css"> <!-- Estilos de modal de recetas -->

    <link rel="stylesheet" href="../style_tarjeta_receta.css"> <!-- Estilos para las tarjetas de recetas -->
    <link rel="stylesheet" href="../style_perfil_usuario.css"> <!-- Estilos para el perfil de usuario -->

    <link rel="stylesheet" href="../Pantalla_principal/chatbot/chatbot.css">

    <link rel="website icon" href="/Images/Icono_veganimo.svg">

    <title>Pantalla Principal</title>
  </head>

<body>

  <button id="toggle-sidebar" class="btn-hamburger">
    <div class="menu-toggle">
      <div class="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>

      <div class="cross">
        <span></span>
        <span></span>
      </div>
    </div>
  </button>


  <div class="container">

    <!-- Sidebar -->
    <nav class="sidebar">
      <div class="logo">
        <svg id="Capa_2" data-name="Capa 2" class="logo-isotipo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 168.68 199.52">
          <defs>
            <style>
              .cls-1 {
                fill: currentColor;
              }
            </style>
          </defs>
          <g id="Veganimo">
            <g>
              <path class="cls-1" d="M86.29,80.26c-.7-.61-1.28-1.32-1.77-2.05,3.86,9,7.35,17.37,8.89,21.71l8.39-17.96c-5.41,2.01-11.23,2.03-15.51-1.7Z"/>
              <path class="cls-1" d="M136.3,0H32.38C14.5,0,0,14.49,0,32.38V167.13c0,17.89,14.5,32.39,32.38,32.39h103.92c17.88,0,32.38-14.5,32.38-32.39V32.38c0-17.89-14.5-32.38-32.38-32.38Zm6.77,33.9c-6.17-.63-10.49,1.22-14.22,4.34-3.91,3.28-5.37,7.22-6.64,10.77-2.46,6.91-3.56,14.68-6.72,21.31-1.54,3.22-4.54,6.39-8.17,8.8l-20.9,44.76h15.89c-1.85-10.13,1.45-20.96,9.71-28.35,7.33-6.55,16.95-8.94,25.92-7.28,1.27,1.45-6.95,10.87-10.25,13.82,3.3-2.95,13.58-10.07,14.89-8.63,.63,9.1-2.8,18.38-10.14,24.94-2.66,2.39-5.63,4.21-8.76,5.5h14.16c3.04,0,5.45,2.6,5.17,5.62-1.57,16.65-10.06,31.28-22.55,41.01-4.3,3.34-9.6,5.13-15.04,5.13-.31,0-.55,.25-.55,.55v2.33c0,1.71-1.39,3.1-3.1,3.1h-34.82c-1.71,0-3.1-1.39-3.1-3.1v-2.33c0-.31-.25-.55-.55-.55h-.25c-5.44,0-10.75-1.79-15.05-5.13-12.49-9.73-20.98-24.36-22.54-41.01-.29-3.02,2.13-5.62,5.16-5.62h23.36c-2.31-.91-4.47-2.3-6.33-4.18-4.77-4.83-6.3-11.64-4.62-17.74,6.13-1.59,12.9,.03,17.67,4.86,4.6,4.66,6.18,11.14,4.8,17.06h14.23L42.97,44.17c-4.22-9.35-8.99-14.02-14.29-14.02h-.45v-1.29h49.92v1.29h-.61c-4.52,0-7.51,1.17-8.98,3.53-1.48,2.36-1.23,5.64,.74,9.84,0,0,6.93,15.5,13.49,30.68,1.45,.76,5.37,.96,6.1,.91,1.77-.12,3.93-.58,5.38-1.45,3.79-2.3,6.64-7.11,7.97-10.94,1.54-4.33,2.59-9.32,4.44-13.83,2.15-5.32,5.27-10.6,10.29-14.42,5.17-4.09,13.11-6.26,20.38-4.16,2.31,.68,4.43,1.79,5.92,3.27l-.2,.32Z"/>
            </g>
          </g>
        </svg>
        
      </div>
      <!-- Enlaces -->
      <ul class="nav-links">

        <!-- Inicio -->
        <li class="nav-item" data-page="pp_inicio.php">
          <div class="nav-content">
             <i class="ph ph-house-simple" style="font-size: 24px;"></i><span>Inicio</span>
          </div>
        </li>

        <!-- Plan usuario / DASHBOARD -->
        <li class="nav-item" data-page="/plan/pp_dashboard_miplan.php">
          <div class="nav-content">
            <i class="ph ph-house-simple" style="font-size: 24px;"></i>
            <span>Plan</span>
          </div>
          <div class="sticker-pro">Pro</div>
        </li> 

        <!-- Plan usuario se ha suscrito-->
        <li class="nav-item" data-page="/plan/pp_suscripcion_act.php">
          <div class="nav-content">
            <i class="ph ph-house-simple" style="font-size: 24px;"></i>
            <span>Plan</span>
          </div>
          <div class="sticker-pro">Pro</div>
        </li>
      
        <!-- Recetas -->
        <li class="nav-item" data-page="pp_recetas.php">
          <div class="nav-content">
            <i class="ph ph-book-open" style="font-size: 24px;"></i><span>Recetas</span>
          </div>
        </li>
      
        <!-- Dieta vegana -->
        <li class="nav-item" data-page="/dieta_vegana/pp_dieta_vegana.php">
          <div class="nav-content">
            <i class="ph ph-leaf" style="font-size: 24px;"></i>
            <span>Dietas veganas</span>
          </div>
          <div class="sticker-pro">Pro</div>
        </li>

        <!-- Dieta vegana IA 
        <li class="nav-item" data-page="/dieta_vegana/pp_ia_dieta_vegana.php">
          <div class="nav-content">
            <i class="ph ph-leaf" style="font-size: 24px;"></i>
            <span>Dietas veganas ia</span>
          </div>
          <div class="sticker-pro">Pro</div>
        </li> -->

        <!-- el usuario no es pro/Dieta vegana -->
        <li class="nav-item" data-page="/dieta_vegana/pp_no_pro_dieta.php">
          <div class="nav-content">
            <i class="ph ph-leaf" style="font-size: 24px;"></i><span>Dietas veganas</span>
          </div>
          <div class="sticker-pro">Pro</div>
        </li>

        <!-- el usuario cancela o modifica la suscripcion o plan -->
        <li class="nav-item" data-page="/dieta_vegana/pp_cancelar_plan_dieta.php">
          <div class="nav-content">
            <i class="ph ph-note-pencil" style="font-size: 24px;"></i><span>Gestión Dietas veganas</span>
          </div>
          <div class="sticker-pro">Pro</div>
        </li>
  
        <!-- Informate -->
        <li class="nav-item has-submenu nav-informate" data-page="pp_informate.php" style="margin-left: -12px;">
          <div class="nav-trigger">
            <i class="ph ph-info" style="font-size: 24px;"></i><span>Infórmate</span><i class="ph ph-caret-down"></i>
          </div>

          <ul class="submenu">
            <li data-name="inf_conceptos">Conceptos</li>
            <li data-name="inf_salud">Salud</li>
            <li data-name="inf_concientizacion">Concientización</li>
          </ul>
        </li>
      
        <!-- ayuda -->
        <li class="nav-item" data-page="pp_ayuda.php">
          <div class="nav-content">
            <i class="ph ph-question" style="font-size: 24px;"></i><span>Ayuda</span>
          </div>
        </li>

        <!-- Crear recetas admi -->
        <li class="nav-item" data-page="pp_crear_receta.php" data-admin-only>
          <div class="nav-content">
            <i class="ph ph-clipboard-text" style="font-size: 24px;"></i><span>Crear recetas</span>
          </div>
        </li>

        <!-- Crear recetas pro -->
        <li class="nav-item" data-custom="crear-recetas-pro" style="display: none;">
          <div class="nav-content">
             <i class="ph ph-clipboard-text" style="font-size: 24px;"></i>
            <span>Enviar solicitud receta</span>
          </div> 
          <div class="sticker-pro">Pro</div>
        </li>
        
     
      </ul>
    
    </nav>

    <!-- Contenido dinámico -->
    <main class="contenido" id="contenido-principal">
      <!-- Aquí se cargará el contenido desde pp_inicio.html, etc -->

    </main>

      <!-- Chatbot Flotante -->
    <div class="chatbot-container" id="chatbotContainer">
      <!-- Botón flotante del chatbot -->
      <div class="chatbot-toggle" id="chatbotToggle">
          <svg class="chatbot-icon" data-name="Capa 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 457.09 414.34">
            <defs>
              <style>
                .cls-1 {
                  fill: #fff;
                }
              </style>
            </defs>
            <g id="Capa_1-2" data-name="Capa 1">
              <g>
                <path class="cls-1" d="m378.66,130.57c-3.44-14.84-12.16-25.58-26.02-32.01-6.55-3.04-13.53-4.04-20.72-4.03-16.23.02-32.47.02-48.7.02,7.77-3.35,15.14-7.99,21.8-13.95,19.28-17.25,28.32-41.68,26.66-65.6-3.44-3.8-30.48,14.93-39.15,22.7,8.67-7.76,30.3-32.55,26.95-36.35-23.58-4.37-48.9,1.91-68.2,19.17-21.57,19.27-30.32,47.54-25.67,74.04-1.75,0-3.5,0-5.25,0h0c-1.88,0-3.76,0-5.64,0,3.22-15.28-1.06-31.83-12.87-43.81-12.54-12.7-30.37-16.98-46.48-12.79-4.42,16.05-.39,33.96,12.13,46.67,4.22,4.27,9.05,7.57,14.2,9.94-24.34,0-48.69,0-73.03,0-4.82,0-9.6.33-14.3,1.66-10.43,2.95-18.81,8.79-25.14,17.53-6.09,8.4-8.56,17.96-8.56,28.22,0,50.22-.02,100.43.02,150.65,0,5.8.88,11.51,3.05,16.93,4.53,11.37,12.28,19.8,23.34,25.09,4.63,2.22,9.49,3.83,14.67,3.98,7.02.21,14.04.25,21.06.28,1.2,0,1.44.35,1.45,1.47.05,12.34.14,24.67.25,37.01.01,1.28.05,2.6.36,3.83,1.57,6.13,8.3,9.45,14.15,5.96,1.67-1,3.2-2.22,4.75-3.41,18.67-14.35,37.34-28.69,55.95-43.11,1.61-1.25,3.15-1.76,5.18-1.75,42.17.06,84.35.06,126.52.03,3.36,0,6.78.04,10.07-.53,11.53-2.02,21.06-7.61,28.39-16.78,7.01-8.76,9.94-18.9,9.94-30,0-49.76.02-99.52-.05-149.28,0-3.92-.22-7.95-1.1-11.75Zm-18.26,160.58c0,6.05-.96,11.82-4.49,16.92-3.85,5.55-8.98,9.35-15.6,10.76-2.93.63-6.02.68-9.04.68-43.21.04-86.43.04-129.64.01-4.02,0-7.51,1.12-10.72,3.61-15.05,11.7-30.17,23.3-45.27,34.93-.54.42-1.12.79-1.68,1.18-.16-.06-.31-.12-.47-.17,0-1.86,0-3.72,0-5.58-.01-7.56-.02-15.12-.04-22.68,0-.58-.03-1.16-.07-1.74-.48-6.7-5.6-9.5-10.98-9.53-7.81-.03-15.62.09-23.43-.05-3.42-.06-6.96-.16-10.23-1.05-10.09-2.74-17.44-11.85-18.37-22.2-.16-1.82-.27-3.65-.27-5.47-.02-49.59-.02-99.18-.02-148.78,0-5.26.77-10.35,3.53-14.95,3.93-6.56,9.57-10.84,17.08-12.46,1.73-.37,3.55-.45,5.33-.45,19.53,0,39.06.04,58.58.04,56.8,0,113.6.06,170.4-.05,10.78-.02,21.27,7.91,24.22,18.27.93,3.27,1.21,6.6,1.21,9.97,0,49.59-.02,99.18,0,148.78Z"/>
                <circle class="cls-1" cx="137.05" cy="222.28" r="16.6"/>
                <circle class="cls-1" cx="220.24" cy="222.28" r="16.6" transform="translate(-20.83 22.78) rotate(-5.65)"/>
                <circle class="cls-1" cx="303.43" cy="222.28" r="16.6" transform="translate(35.42 486.18) rotate(-80.78)"/>
                <path class="cls-1" d="m405.35,8.74c-9.02,35.4-16.34,42.72-51.74,51.74,35.4,9.02,42.72,16.34,51.74,51.74,9.02-35.4,16.34-42.72,51.74-51.74-35.4-9.02-42.72-16.34-51.74-51.74Z"/>
                <path class="cls-1" d="m36.59,341.16c-6.38,25.03-11.55,30.21-36.59,36.59,25.03,6.38,30.21,11.55,36.59,36.59,6.38-25.03,11.55-30.21,36.59-36.59-25.03-6.38-30.21-11.55-36.59-36.59Z"/>
              </g>
            </g>
          </svg>
        <span class="chatbot-notification" id="chatbotNotification">1</span>
      </div>
      
      <!-- Ventana del chatbot -->
      <div class="chatbot-window" id="chatbotWindow">
        <!-- Encabezado -->
        <div class="chatbot-header">
          <div class="chatbot-avatar">
            <img src="/Images/Avatares/cabeza_chatbot.svg" alt="">
          </div>
          <div class="chatbot-info">
            <h3>Asistente Veganimo</h3>
            <span class="chatbot-status">En línea</span>
          </div>
          <button class="chatbot-close" id="chatbotClose">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16">
              <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
            </svg>
          </button>
        </div>
        
        <!-- Mensajes -->
        <div class="chatbot-messages" id="chatbotMessages">
          <!-- Pantalla inicial con mascota -->
          <div class="welcome-screen" id="welcomeScreen">
            <div class="mascot-container">
              <div class="mascot-avatar">
                <div id="mascot-chatbot" class="bot-container"></div>
                <div class="mascot-circle"></div>
              </div>
              <div class="welcome-message">
                <p class="user-greeting">Hola, Usuario!</p>
                <p class="bot-question">¿En qué puedo ayudarte?</p>
                <p class="bot-prompt">Pregunta lo que quieras...</p>
              </div>
            </div>
          </div>
          
          <!-- Área de chat normal (oculta inicialmente) -->
          <div class="chat-area" id="chatArea" style="display: none;">
            <!-- Los mensajes del chat se agregarán aquí dinámicamente -->
          </div>
        </div>
        
        <!-- Input -->
        <div class="chatbot-input-container">
          <input type="text" class="chatbot-input" id="chatbotInput" placeholder="Escribe tu mensaje...">
          <button class="chatbot-send" id="chatbotSend">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="circle-send">
              <path fill="none" d="M0 0h24v24H0z"></path>
              <path fill="currentColor" d="M1.946 9.315c-.522-.174-.527-.455.01-.634l19.087-6.362c.529-.176.832.12.684.638l-5.454 19.086c-.15.529-.455.547-.679.045L12 14l6-8-8 6-8.054-2.685z"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <div id="app-search"></div> <!-- Busqueda tarjetas -->
    
  </div>

  <!-- FOOTER -->
  <footer id="footer-pp">
    <div class="ListFooter">
    <!-- Columna izquierda: Logo y descripción -->
    <div class="logoarea">
        <div class="logo-container">
        <img class="logoFooter" src="/Images/isotipo_slogan.png" alt="Logo Vegánimo" style="width: auto; height: 60px; margin-left: 0px;" ondragstart="return false;">
        </div>
        <p class="nosotros">
        Somos una empresa que crea dietas y recetas con la finalidad de mejorar la salud y el veganismo.
        </p>
    </div>

    <!-- Columna derecha: Afiliados -->
    <div class="afiliados">
        <h2>Afiliados</h2>
        <ul role="list">
        <li>Jane Doe</li>
        <li>Jenny Flores</li>
        </ul>
    </div>
    </div>

    <!-- Línea divisoria -->
    <div class="lineafooter"></div>

    <!-- Área de copyright -->
    <div class="area-copy">
    <p class="copyFooter">&copy; Derechos reservados por Vegánimo</p>
    </div>
  </footer>



  <!-- SCRIPTS DE LA PANTALLA PRINCIPAL -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>  <!-- SweetAlert -->
  <script src="https://unpkg.com/phosphor-icons"></script> <!-- Iconos -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script> <!-- Cropper -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>


  <script src="../Pantalla_principal/js/scripts_index_pp.js"></script>   <!-- pantalla principal de la app - Importante y principal primario -->

  <script src="../Pantalla_principal/chatbot/chatbot.js"></script>

  <script src="../Pantalla_principal/contenidos/plan/popup-guia.js"></script>
  <script src="../Pantalla_principal/contenidos/plan/modales-plan.js"></script>
 
  <script src="../Pantalla_principal/js/filtrado_posicion_tarjeta.js"></script>  <!-- Busqueda de tarjetas y animacion en posicion en pp_recetas.html -->
  <script src="../Pantalla_principal/js/cargar_recetas.js"></script>  <!-- Cargar recetas en pp_recetas.html -->

  <script src="../Pantalla_principal/js/modal_recetas.js"></script>

  <script src="../Pantalla_principal/js/crear_receta.js"></script>
  <script src="../Pantalla_principal/js/validacion_receta.js"></script>  <!-- metodos de interfaz de crear receta -->
  <script src="../Pantalla_principal/js/guardar_recetas.js"></script>  <!-- Guardar recetas -->
  <script src="../Pantalla_principal/js/validacion_crear_receta.js"></script>
  <!-- scrip de enviar receta de usuario pro la solicitud  -->
  <script src="../Pantalla_principal/js/guardar_recetaspro.js"></script>
  

  <!-- MENU Y POPUP PERFIL NUTRC + CONFIGURACIÓN -->
  <script src="../perfil_nutric_popup.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      await actualizarPerfilUsuario();
      await verificarRolUsuario();
    });

  function toggleConfig() {
    const submenu = document.getElementById("submenu-config");
    const arrow = document.getElementById("config-arrow");

    // Alternar visibilidad del submenú
    if (submenu.style.display === "block") {
      submenu.style.display = "none";
      arrow.classList.remove("rotated");
    } else {
      submenu.style.display = "block";
      arrow.classList.add("rotated");
    }
}

  </script>
<script>
    window.addEventListener('pageshow', function(event) {
        if (event.persisted || (window.performance && window.performance.navigation.type === 2)) {
            // Si se accede desde el caché (por botón atrás), forzar recarga
            window.location.reload();
        }
    });
</script>

  

</body>

</html>

<script>
  document.addEventListener("DOMContentLoaded", () => {
  // Lógica para cargar contenido de los items normales
  const contenido = document.getElementById("contenido-principal");

  // Crear Recetas manual
  const crearRecetasBtn = document.querySelector('[data-custom="crear-recetas"]');
  if (crearRecetasBtn) {
    crearRecetasBtn.addEventListener("click", () => {
      fetch("/Pantalla_principal/contenidos/pp_crear_recetas.html")
        .then(res => res.text())
        .then(data => {
          contenido.innerHTML = data;
        })
        .catch(err => {
          console.error("Error cargando Crear Recetas:", err);
        });
    });
  }
});

</script>



