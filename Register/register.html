<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Regístrate</title>

  <link rel="website icon" href="../Images/Icono_veganimo.svg">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Iconos -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&family=Gloock&display=swap" rel="stylesheet" />

  <!-- CSS personalizado -->
  <link rel="stylesheet" href="/Register/register.css" />

  <!-- SweetAlert -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- JS personalizado -->
  <script src="/Register/registro.php" defer></script>

  <!-- FIREBASE -->
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-auth-compat.js"></script>
  
  <script src="veganimo-app.js"></script>

  <!-- Alertify -->
    <script src="https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>
  

</head>
<body class="custom-bg d-flex min-vh-100 px-3">

  <!-- Contenedor general -->
  <div class="container position-relative d-flex align-items-center">

    <!-- Card del formulario -->
    <div class="card shadow-lg rounded-4 overflow-hidden custom-form-card p-4">
      <div class="text-center mb-4">
        <div class="logo-container">
          <div class="img-fluid logo" alt="isotipo">
            <?xml version="1.0" encoding="UTF-8"?>
              <svg id="Capa_2" data-name="Capa 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 168.68 199.52">
              <g id="Veganimo">
                  <g>
                  <path class="cls-1" d="M86.29,80.26c-.7-.61-1.28-1.32-1.77-2.05,3.86,9,7.35,17.37,8.89,21.71l8.39-17.96c-5.41,2.01-11.23,2.03-15.51-1.7Z"/>
                  <path class="cls-1" d="M136.3,0H32.38C14.5,0,0,14.49,0,32.38V167.13c0,17.89,14.5,32.39,32.38,32.39h103.92c17.88,0,32.38-14.5,32.38-32.39V32.38c0-17.89-14.5-32.38-32.38-32.38Zm6.77,33.9c-6.17-.63-10.49,1.22-14.22,4.34-3.91,3.28-5.37,7.22-6.64,10.77-2.46,6.91-3.56,14.68-6.72,21.31-1.54,3.22-4.54,6.39-8.17,8.8l-20.9,44.76h15.89c-1.85-10.13,1.45-20.96,9.71-28.35,7.33-6.55,16.95-8.94,25.92-7.28,1.27,1.45-6.95,10.87-10.25,13.82,3.3-2.95,13.58-10.07,14.89-8.63,.63,9.1-2.8,18.38-10.14,24.94-2.66,2.39-5.63,4.21-8.76,5.5h14.16c3.04,0,5.45,2.6,5.17,5.62-1.57,16.65-10.06,31.28-22.55,41.01-4.3,3.34-9.6,5.13-15.04,5.13-.31,0-.55,.25-.55,.55v2.33c0,1.71-1.39,3.1-3.1,3.1h-34.82c-1.71,0-3.1-1.39-3.1-3.1v-2.33c0-.31-.25-.55-.55-.55h-.25c-5.44,0-10.75-1.79-15.05-5.13-12.49-9.73-20.98-24.36-22.54-41.01-.29-3.02,2.13-5.62,5.16-5.62h23.36c-2.31-.91-4.47-2.3-6.33-4.18-4.77-4.83-6.3-11.64-4.62-17.74,6.13-1.59,12.9,.03,17.67,4.86,4.6,4.66,6.18,11.14,4.8,17.06h14.23L42.97,44.17c-4.22-9.35-8.99-14.02-14.29-14.02h-.45v-1.29h49.92v1.29h-.61c-4.52,0-7.51,1.17-8.98,3.53-1.48,2.36-1.23,5.64,.74,9.84,0,0,6.93,15.5,13.49,30.68,1.45,.76,5.37,.96,6.1,.91,1.77-.12,3.93-.58,5.38-1.45,3.79-2.3,6.64-7.11,7.97-10.94,1.54-4.33,2.59-9.32,4.44-13.83,2.15-5.32,5.27-10.6,10.29-14.42,5.17-4.09,13.11-6.26,20.38-4.16,2.31,.68,4.43,1.79,5.92,3.27l-.2,.32Z"/>
                  </g>
              </g>
              </svg>
          </div>
        </div>
      </div>
      
      
      <h2 class="form-title text-center mb-2">Crea tu cuenta</h2>
      <div class="separator mx-auto mb-4"></div>

      <!--  FORMULARIO DE REGISTRO-USUARIOS -->
      <form action="registro.php" method="POST">
<!-- Nombre completo -->
<div class="mb-3">
  <label for="fullname" class="form-label">Nombre completo:</label>
  <input type="text" name="fullname" id="fullname" class="form-control input-border"
         pattern="[a-zA-Z]{3,}[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]*"
         placeholder="Ingrese su nombre completo"
         title="Por favor ingrese correctamente sus datos, solo se permiten letras"
         required />
  <div id="fullname-message" class="form-text mt-1">Solo se permiten letras y espacios.</div>
</div>

<script>
  const fullnameInput = document.getElementById('fullname');
  const fullnameMessage = document.getElementById('fullname-message');
  const regex = /^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]{3,}$/;

  fullnameInput.addEventListener('input', function () {
    const value = this.value.trim();

    if (regex.test(value)) {
      fullnameMessage.textContent = 'Datos correctos ✅';
      fullnameMessage.className = 'form-text mt-1 text-success';
      this.classList.add('is-valid');
      this.classList.remove('is-invalid');
    } else {
      fullnameMessage.textContent = 'Ingrese solo letras';
      fullnameMessage.className = 'form-text mt-1 text-danger';
      this.classList.add('is-invalid');
      this.classList.remove('is-valid');
    }
  });

  fullnameInput.addEventListener('keydown', function (e) {
    const char = e.key;

    // Permitir teclas de control y navegación
    if (
      e.ctrlKey || e.metaKey ||
      ['Backspace', 'Delete', 'ArrowLeft', 'ArrowRight', 'Tab'].includes(char)
    ) return;

    const currentValue = fullnameInput.value;

    // Bloquear espacio si hay menos de 3 letras
    if (char === ' ' && currentValue.length < 3) {
      e.preventDefault();
      return;
    }

    // Bloquear todo lo que no sea letra o espacio
    if (!/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]$/.test(char)) {
      e.preventDefault();
    }
  });

  // Evitar pegar texto con caracteres no permitidos
  fullnameInput.addEventListener('paste', function (e) {
    const pasted = e.clipboardData.getData('text');
    if (!/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]*$/.test(pasted)) {
      e.preventDefault();
      fullnameMessage.textContent = 'No se permiten números ni signos al pegar';
      fullnameMessage.className = 'form-text mt-1 text-danger';
    }
  });
</script>




<!-- Fecha de nacimiento -->
<div class="d-flex justify-content-center gap-3">
  <div class="mb-3 flex-fill">
    <label for="birthdate" class="form-label" id="fechana">Fecha de nacimiento:</label>
    <input type="date" name="birthdate" id="birthdate" class="form-control input-border"
           min="1925-01-01" max="2007-12-31" required />
    <div id="birthdate-message" class="form-text mt-1">Debe estar entre el año 1925 y 2007.</div>
  </div>

 <script>
  const birthdateInput = document.getElementById('birthdate');
  const messageDiv = document.getElementById('birthdate-message');

  birthdateInput.addEventListener('input', function () {
    const value = this.value;
    const inputDate = new Date(value);
    const today = new Date();

    if (!value) {
      messageDiv.textContent = 'Debe ingresar una fecha de nacimiento.';
      messageDiv.className = 'form-text mt-1 text-danger';
      this.classList.remove('is-valid', 'is-invalid');
      return;
    }

    // Calcular la edad exacta
    const age = today.getFullYear() - inputDate.getFullYear();
    const monthDiff = today.getMonth() - inputDate.getMonth();
    const dayDiff = today.getDate() - inputDate.getDate();
    let is18 = false;

    if (
      age > 18 ||
      (age === 18 && (monthDiff > 0 || (monthDiff === 0 && dayDiff >= 0)))
    ) {
      is18 = true;
    }

    // Validaciones
    const minDate = new Date('1925-01-01');
    if (inputDate < minDate) {
      messageDiv.textContent = 'La fecha no puede ser menor a 1925.';
      messageDiv.className = 'form-text mt-1 text-danger';
      this.classList.remove('is-valid');
      this.classList.add('is-invalid');
    } else if (!is18) {
      messageDiv.textContent = 'Debe tener al menos 18 años para registrarse.';
      messageDiv.className = 'form-text mt-1 text-danger';
      this.classList.remove('is-valid');
      this.classList.add('is-invalid');
    } else {
      messageDiv.textContent = 'Fecha válida. Todo está correcto ✅';
      messageDiv.className = 'form-text mt-1 text-success';
      this.classList.remove('is-invalid');
      this.classList.add('is-valid');
    }
  });

  // Evita mostrar el borde rojo al cargar
  window.addEventListener('DOMContentLoaded', () => {
    birthdateInput.classList.remove('is-invalid', 'is-valid');
  });
</script>

          <!-- Género -->
          <div class="mb-3 flex-fill">
          <label for="gender" class="form-label">Género:</label>
           <select name="gender" id="gender" class="form-control input-border custom-select" required>
           <option value="" disabled selected>Seleccionar</option>
           <option value="Femenino">Femenino</option>
         <option value="Masculino">Masculino</option>
         </select>
        </div>
          </div>

          <script>
  const genderSelect = document.getElementById('gender');
  const genderMessage = document.getElementById('gender-message');
  const form = document.getElementById('registroForm');

  // Al cargar, limpiar estilos
  window.addEventListener('DOMContentLoaded', () => {
    genderSelect.classList.remove('is-valid', 'is-invalid');
    genderMessage.style.display = 'none';
  });

  // Validar al seleccionar una opción
  genderSelect.addEventListener('change', function () {
    if (this.value !== "") {
      this.classList.remove('is-invalid');
      this.classList.add('is-valid');
      genderMessage.textContent = 'Selección válida ✅';
      genderMessage.className = 'form-text mt-1 text-success';
      genderMessage.style.display = 'block';
    }
  });

  // Validar al enviar el formulario
  form.addEventListener('submit', function (e) {
    let valid = true;

    // Validación del género
    if (genderSelect.value === "") {
      genderSelect.classList.remove('is-valid');
      genderSelect.classList.add('is-invalid');
      genderMessage.textContent = 'Debe seleccionar un género.';
      genderMessage.className = 'form-text mt-1 text-danger';
      genderMessage.style.display = 'block';
      valid = false;
    }

    // Cancelar envío si algo no es válido
    if (!valid) {
      e.preventDefault();
    }
  });
</script>
        
<!-- Correo -->
<div class="mb-3">
  <label for="email" class="form-label">Correo:</label>
  <input type="email" name="email" id="email" class="form-control input-border" placeholder="Ingrese su correo" required />
  <div id="email-message" class="form-text mt-1">Ingrese un correo válido (ejemplo@gmail.com)</div>
</div>

<script>
  const emailInput = document.getElementById('email');
  const emailMessage = document.getElementById('email-message');
  // Expresión regular para correos con extensiones válidas y dominio completo
  const emailRegex = /^[a-zA-Z0-9._%+-]+@(gmail\.com|yahoo\.com|hotmail\.com|outlook\.com|ugb\.edu\.sv|co\.sv|co\.uk|co\.nz|tv|me|int|io|info|us|sg|ca|au)\b$/;

  emailInput.addEventListener('keydown', function (e) {
    // Prevenir el espacio
    if (e.key === ' ') {
      e.preventDefault();
    }
  });

  emailInput.addEventListener('input', function () {
    const value = this.value;

    if (emailRegex.test(value)) {
      emailMessage.textContent = 'Correo válido ✅';
      emailMessage.className = 'form-text mt-1 text-success';
      this.classList.add('is-valid');
      this.classList.remove('is-invalid');
    } else {
      emailMessage.textContent = 'Ingrese un correo válido (ejemplo@gmail.com)';
      emailMessage.className = 'form-text mt-1 text-danger';
      this.classList.add('is-invalid');
      this.classList.remove('is-valid');
    }
  });
</script>




<!-- Contraseña -->
<div class="mb-3">
  <label for="password" class="form-label">Contraseña:</label>
  <div class="position-relative">
    <input type="password" id="password" name="password"
           class="form-control input-border"
           placeholder="Ingrese su contraseña" required />
    <span class="password-toggle-inside" onclick="toggleVisibility('password', this)">
      <i class="fas fa-eye"></i>
    </span>
  </div>
  <div id="password-message" class="form-text mt-1">
    <ul class="mb-0">
      <li id="req-length">Al menos 6 caracteres <span id="check-length" style="display:none; color:green;">✔️</span></li>
      <li id="req-uppercase">Debe tener al menos una mayúscula <span id="check-uppercase" style="display:none; color:green;">✔️</span></li>
      <li id="req-number">Debe tener al menos un número <span id="check-number" style="display:none; color:green;">✔️</span></li>
      <li id="req-symbol">Debe tener al menos un signo (!@#$%^.,&*) <span id="check-symbol" style="display:none; color:green;">✔️</span></li>
      <li id="req-space">No debe tener espacios <span id="check-space" style="display:none; color:green;">✔️</span></li>
    </ul>
  </div>
</div>

<!-- Confirmar contraseña -->
<div class="mb-3">
  <label for="confirm-password" class="form-label">Confirmar contraseña:</label>
  <div class="position-relative">
    <input type="password" id="confirm-password" name="confirm-password"
           class="form-control input-border"
           placeholder="Confirme su contraseña" required />
    <span class="password-toggle-inside" onclick="toggleVisibility('confirm-password', this)">
      <i class="fas fa-eye"></i>
    </span>
  </div>
  <div id="match-message" class="form-text mt-1"></div>
</div>

<script>
  function toggleVisibility(id, icon) {
    const input = document.getElementById(id);
    if (input.type === "password") {
      input.type = "text";
      icon.innerHTML = '<i class="fas fa-eye-slash"></i>';
    } else {
      input.type = "password";
      icon.innerHTML = '<i class="fas fa-eye"></i>';
    }
  }

  const passwordInput = document.getElementById('password');
  const confirmPasswordInput = document.getElementById('confirm-password');
  const matchMessage = document.getElementById('match-message');

  const reqLength = document.getElementById('req-length');
  const reqUppercase = document.getElementById('req-uppercase');
  const reqNumber = document.getElementById('req-number');
  const reqSymbol = document.getElementById('req-symbol');
  const reqSpace = document.getElementById('req-space');

  const checkLength = document.getElementById('check-length');
  const checkUppercase = document.getElementById('check-uppercase');
  const checkNumber = document.getElementById('check-number');
  const checkSymbol = document.getElementById('check-symbol');
  const checkSpace = document.getElementById('check-space');

  // Bloquear espacios
  passwordInput.addEventListener('keydown', function (e) {
    if (e.key === ' ') {
      e.preventDefault();
    }
  });

  confirmPasswordInput.addEventListener('keydown', function (e) {
    if (e.key === ' ') {
      e.preventDefault();
    }
  });

  // Verificar todas las validaciones de la contraseña
  function allValidationsPassed() {
    const value = passwordInput.value;
    return (
      value.length >= 6 &&
      /[A-Z]/.test(value) &&
      /\d/.test(value) &&
      /[!@#$%^&*()\-_=+[\]{};:'",.<>/?\\|`~]/.test(value) &&
      !/\s/.test(value)
    );
  }

  // Actualizar mensaje y color de validación
  function updateItem(element, isValid, text, checkIcon) {
    element.textContent = text;
    element.className = isValid ? 'text-success' : 'text-danger';
    checkIcon.style.display = isValid ? 'inline' : 'none'; // Mostrar el cheque cuando sea válido
  }

  // Verificar si la contraseña y la confirmación coinciden
  function checkPasswordMatch() {
    const password = passwordInput.value;
    const confirm = confirmPasswordInput.value;

    if (confirm === '') {
      matchMessage.textContent = '';
      confirmPasswordInput.style.borderColor = '';
    } else if (password === confirm && allValidationsPassed()) {
      matchMessage.textContent = 'Las contraseñas coinciden';
      matchMessage.className = 'form-text mt-1 text-success';
      confirmPasswordInput.style.borderColor = 'green';
    } else {
      matchMessage.textContent = 'Las contraseñas no coinciden';
      matchMessage.className = 'form-text mt-1 text-danger';
      confirmPasswordInput.style.borderColor = '';
    }
  }

  // Escuchar cambios en la contraseña
  passwordInput.addEventListener('input', function () {
    const value = this.value;

    // Actualizar las validaciones
    updateItem(reqLength, value.length >= 6, 'Al menos 6 caracteres', checkLength);
    updateItem(reqUppercase, /[A-Z]/.test(value), 'Debe tener al menos una mayúscula', checkUppercase);
    updateItem(reqNumber, /\d/.test(value), 'Debe tener al menos un número', checkNumber);
    updateItem(
      reqSymbol,
      /[!@#$%^&*()\-_=+[\]{};:'",.<>/?\\|`~]/.test(value),
      'Debe tener al menos un signo (!@#$%^&*()[]{};:,.<>?\\| etc.)',
      checkSymbol
    );
    updateItem(reqSpace, !/\s/.test(value), 'No debe tener espacios', checkSpace);

    // Actualizar el borde del input de la contraseña
    if (allValidationsPassed()) {
      passwordInput.style.borderColor = 'green';
    } else {
      passwordInput.style.borderColor = '';
    }

    checkPasswordMatch();
  });

  // Escuchar cambios en la confirmación de la contraseña
  confirmPasswordInput.addEventListener('input', checkPasswordMatch);
</script>





        <div class="text-center">
          <button type="submit">Registrar</button>
        </div>
      </form>

      <div class="text-center mt-3">
        <a href="Login/login.html" class="text-muted small text-decoration-none">¿Tienes cuenta? Inicia sesión</a>
      </div>
      </div>
    </div>

    <!-- Imagen derecha -->
    <img src="https://images.pexels.com/photos/31199411/pexels-photo-31199411/free-photo-of-ensalada-de-aguacate-fresco-y-rucula-en-una-mesa-rustica.jpeg?auto=compress&cs=tinysrgb&w=600&lazy=load" 
         alt="Imagen" 
         class="img-fluid login-image d-none d-md-block" />

  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


  <!-- Script para mostrar/ocultar contraseñas -->
  <script>
    function toggleVisibility(inputId, iconElement) {
      const input = document.getElementById(inputId);
      const icon = iconElement.querySelector('i');
      const isPassword = input.type === 'password';

      input.type = isPassword ? 'text' : 'password';
      icon.classList.toggle('fa-eye-slash', isPassword);
      icon.classList.toggle('fa-eye', !isPassword);
    }
     
    
    
    
  </script>
  
  <script src="register.js"></script>

</body>
</html>
